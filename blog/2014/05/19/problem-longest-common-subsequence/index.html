<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>
       Problem: Longest Common Subsequence &middot;  Hujiawei Bujidao
    </title>

    <meta name="generator" content="Hugo 0.67.0" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta property="og:title" content=" Problem: Longest Common Subsequence &middot;  Hujiawei Bujidao" />
  	<meta property="og:site_name" content="Hujiawei Bujidao" />
  	<meta property="og:url" content="https://hujiaweibujidao.github.io/blog/2014/05/19/problem-longest-common-subsequence/" />

    
  	<meta property="og:type" content="article" />
    <meta property="og:article:published_time" content="2014-05-19T00:00:00Z" />
    
    <meta property="og:article:tag" content="algorithm" />
    
    

    <meta name="description" content="Happy Coding &amp; Enjoy Living" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://hujiaweibujidao.github.io/images/favicon.ico">
	  <link rel="apple-touch-icon" href="https://hujiaweibujidao.github.io/images/apple-touch-icon.png" />
    <link rel="stylesheet" type="text/css" href="https://hujiaweibujidao.github.io/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="https://hujiaweibujidao.github.io/css/nav.css" />
    <link rel="stylesheet" type="text/css" href="https://hujiaweibujidao.github.io/css/hugo.css" />

    
    <link rel="stylesheet" type="text/css" href="https://hujiaweibujidao.github.io/css/highlight.css">
    
    <link rel="stylesheet" type="text/css" href="https://hujiaweibujidao.github.io/css/github-gist.css">
    
    <script src="https://hujiaweibujidao.github.io/js/highlight.js"></script>
    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

    
    

    

    <link rel="canonical" href="https://hujiaweibujidao.github.io/blog/2014/05/19/problem-longest-common-subsequence/" />

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        

        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://hujiaweibujidao.github.io/">Home</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://hujiaweibujidao.github.io/about">About</a>
            </li>
        

        <li class="nav-opened" role="presentation"><a href=""></a></li>
        <li class="nav-opened" role="presentation"><a href="https://hujiaweibujidao.github.io/tags/algorithm/">tags/algorithm</a></li>
        <li class="nav-opened" role="presentation"><a href="https://hujiaweibujidao.github.io/tags/android/">tags/android</a></li>
        <li class="nav-opened" role="presentation"><a href="https://hujiaweibujidao.github.io/tags/swift/">tags/swift</a></li>
        <li class="nav-opened" role="presentation"><a href="https://hujiaweibujidao.github.io/tags/reactnative/">tags/reactnative</a></li>
        <li class="nav-opened" role="presentation"><a href="https://hujiaweibujidao.github.io/tags/python/">tags/python</a></li>
        <li class="nav-opened" role="presentation"><a href="https://hujiaweibujidao.github.io/tags/java/">tags/java</a></li>
        <li class="nav-opened" role="presentation"><a href="https://hujiaweibujidao.github.io/tags/dev/">tags/dev</a></li>
        <li class="nav-opened" role="presentation"><a href="https://hujiaweibujidao.github.io/tags/life/">tags/life</a></li>
    </ul>

    
    

    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




  <header class="main-header post-head" style="background-image: url(https://www.bing.com/ImageResolution.aspx?w=1366&amp;h=768)">
  

    <nav class="main-nav overlay clearfix">
    
        
    
    
        <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
    
</nav>

    <div class="vertical">
        <div class="main-header-content inner">
            <h1 class="page-title">Problem: Longest Common Subsequence</h1>
            <h2 class="page-description">Hujiawei Bujidao</h2> <br/>
            
    <a class="bloglogo" href="https://github.com/hujiaweibujidao" target="_blank">
    <span class="icon-github" style="color:white;font-size:2em"></span>
    </a>
&nbsp;


    <a class="bloglogo" href="https://weibo.com/hujiaweiyinger" target="_blank">
        <span class="icon-twitter" style="color:white;font-size:2em"></span>
    </a>
&nbsp;




    <a class="bloglogo" href="https://www.linkedin.com/in/hujiaweibujidao" target="_blank">
        <span class="icon-linkedin" style="color:white;font-size:2em"></span>
    </a>
&nbsp;


        </div>
    </div>
</header>



<main class="content" role="main">
  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Problem: Longest Common Subsequence</h1>
        

        <section class="post-meta">
        
          <span class="post-tag small"><a href="https://hujiaweibujidao.github.io/tags/algorithm/">#algorithm</a></span>
        
        &nbsp;&nbsp;
        
          <time class="post-date" datetime="2014-05-19T00:00:00Z">
            2014/5/19
          </time>
        
        </section>
        <br/>
    </header>

    <section class="post-content">
      <p>最长公共子序列(LCS)是典型的动态规划问题，如果不理解动态规划请移步先看<a href="https://hujiaweibujidao.github.io/blog/2014/07/01/python-algorithms---c8-dynamic-programming/">这篇动态规划的总结</a>，否则本文中的代码实现会不理解的哟！</p>
<p>LCS问题的一个变种就是求最长单调递增子序列，它的一种简易求解方法就是先将原序列A进行排序得到序列B，然后求解序列A和序列B的最长公共子序列。</p>
<p>1.问题描述</p>
<p><img src="https://hujiaweibujidao.github.io/images/algos/lcs1.png" alt="image"></p>
<p>2.最优子结构和子问题重叠</p>
<p><img src="https://hujiaweibujidao.github.io/images/algos/lcs2.png" alt="image"></p>
<p>3.5种实现方式</p>
<p>根据LCS的递推公式</p>
<p>$$
c[i][j]=  \left{
\begin{array}{l l}
0 &amp; \quad \text{i=0 或者 j=0}\<br>
c[i-1][j-1]+1 &amp; \quad \text{i,j&gt;0,且$x_{i}=y_{j}$}\<br>
max({c[i][j-1],c[i-1][j]}) &amp; \quad \text{i,j&gt;0,且$x_{i} \ne y_{j}$}
\end{array} \right.
$$</p>
<p>(1)从中可以看出计算c[i][j]时只需要2行即可，前一行(i-1)和当前行(i)，每行的长度是min{m,n}，首先初始化前一行都为0，然后计算当前行的值，当要计算下一行之前将当前行的值复制到前一行中即可。</p>
<p>(2)从递推公式中还可以看出计算当前行i的话，其实只需要一行再加上O(1)的额外空间就行了。因为计算c[i][j]只需要前一行中c[i-1][k] (k&gt;=j-1)的数据，对于k&lt;j-1的数据都是没有用的，而当前行c[i]<a href="l%3C=j-1">l</a>的数据都是有用的，要用来计算下一行的值，所以，可以在计算当前行的时候，将当前行的前面计算好的部分复制到前一行中对应位置上，但是c[i][j-1]除外，因为c[i-1][j-1]也是需要的，所以需要额外的O(1)的空间保存c[i][j-1]。</p>
<p>LCS的五种实现：分别为0：直接递归；1：带备忘录的递归；2：使用二维数组保存结果的迭代；3：使用2个一维数组保存结果的迭代；4：使用1个一维数组和额外的O(1)空间保存结果的迭代。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lcs0</span>(i,j):
    <span style="color:#75715e">#string starts at index 0, not 1</span>
    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">or</span> j<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>: <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span> <span style="color:#75715e">#attention to this!!!</span>
    <span style="color:#66d9ef">if</span> x[i]<span style="color:#f92672">==</span>y[j]:  <span style="color:#66d9ef">return</span> lcs0(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> max(lcs0(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,j),lcs0(i,j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))

x,y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;abcde&#39;</span>,<span style="color:#e6db74">&#39;oaob&#39;</span>
lenx,leny<span style="color:#f92672">=</span>len(x),len(y)
<span style="color:#66d9ef">print</span>(lcs0(lenx<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,leny<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)) <span style="color:#75715e">#2</span>

<span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> wraps

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">memo</span>(func):
    cache<span style="color:#f92672">=</span>{}
    <span style="color:#a6e22e">@wraps</span>(func)
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">wrap</span>(<span style="color:#f92672">*</span>args):
        <span style="color:#66d9ef">if</span> args <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> cache:
            cache[args]<span style="color:#f92672">=</span>func(<span style="color:#f92672">*</span>args)
        <span style="color:#66d9ef">return</span> cache[args]
    <span style="color:#66d9ef">return</span> wrap

<span style="color:#a6e22e">@memo</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lcs1</span>(i,j):
    <span style="color:#75715e">#string starts at index 0, not 1</span>
    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">or</span> j<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>: <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span> <span style="color:#75715e">#attention to this!!!</span>
    <span style="color:#66d9ef">if</span> x[i]<span style="color:#f92672">==</span>y[j]:  <span style="color:#66d9ef">return</span> lcs1(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> max(lcs1(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,j),lcs1(i,j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))

x,y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;abcde&#39;</span>,<span style="color:#e6db74">&#39;oaob&#39;</span>
lenx,leny<span style="color:#f92672">=</span>len(x),len(y)
<span style="color:#66d9ef">print</span>(lcs1(lenx<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,leny<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)) <span style="color:#75715e">#2</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lcs2</span>(x,y):
    lenx,leny<span style="color:#f92672">=</span>len(x),len(y)
    minlen,maxlen<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">if</span> lenx<span style="color:#f92672">&lt;</span>leny: minlen,maxlen<span style="color:#f92672">=</span>lenx,leny; x,y<span style="color:#f92672">=</span>y,x
    <span style="color:#66d9ef">else</span>: minlen,maxlen<span style="color:#f92672">=</span>leny,lenx;
    <span style="color:#75715e">#s is maxlen * minlen</span>
    s<span style="color:#f92672">=</span>[[<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(minlen)] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(maxlen)]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(maxlen): <span style="color:#75715e">#so, let x be the longer string!!!</span>
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(minlen):
            <span style="color:#66d9ef">if</span> x[i]<span style="color:#f92672">==</span>y[j]: s[i][j]<span style="color:#f92672">=</span>s[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
            <span style="color:#66d9ef">else</span>: s[i][j]<span style="color:#f92672">=</span>max(s[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>][j],s[i][j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
    <span style="color:#66d9ef">return</span> s

x,y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;abcde&#39;</span>,<span style="color:#e6db74">&#39;oaob&#39;</span>
s<span style="color:#f92672">=</span>lcs2(x,y)
<span style="color:#66d9ef">print</span>(s) <span style="color:#75715e">#[[0, 1, 1, 1], [0, 1, 1, 2], [0, 1, 1, 2], [0, 1, 1, 2], [0, 1, 1, 2]]</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lcs3</span>(x,y):
    lenx,leny<span style="color:#f92672">=</span>len(x),len(y)
    minlen,maxlen<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">if</span> lenx<span style="color:#f92672">&lt;</span>leny: minlen,maxlen<span style="color:#f92672">=</span>lenx,leny; x,y<span style="color:#f92672">=</span>y,x
    <span style="color:#66d9ef">else</span>: minlen,maxlen<span style="color:#f92672">=</span>leny,lenx;
    <span style="color:#75715e">#s is maxlen * minlen</span>
    pre<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(minlen)]
    cur<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(minlen)]
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(maxlen): <span style="color:#75715e">#so, let x be the longer string!!!</span>
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(minlen):
            <span style="color:#66d9ef">if</span> x[i]<span style="color:#f92672">==</span>y[j]: cur[j]<span style="color:#f92672">=</span>pre[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
            <span style="color:#66d9ef">else</span>: cur[j]<span style="color:#f92672">=</span>max(pre[j],cur[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
        pre[:]<span style="color:#f92672">=</span>cur[:]
    <span style="color:#66d9ef">return</span> cur

x,y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;abcde&#39;</span>,<span style="color:#e6db74">&#39;oaob&#39;</span>
s<span style="color:#f92672">=</span>lcs3(x,y)
<span style="color:#66d9ef">print</span>(s) <span style="color:#75715e">#[2, 2, 2, 2]</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lcs4</span>(x,y):
    lenx,leny<span style="color:#f92672">=</span>len(x),len(y)
    minlen,maxlen<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">if</span> lenx<span style="color:#f92672">&lt;</span>leny: minlen,maxlen<span style="color:#f92672">=</span>lenx,leny; x,y<span style="color:#f92672">=</span>y,x
    <span style="color:#66d9ef">else</span>: minlen,maxlen<span style="color:#f92672">=</span>leny,lenx;
    <span style="color:#75715e">#s is maxlen * minlen</span>
    s<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(minlen)]
    t<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(maxlen): <span style="color:#75715e">#so, let x be the longer string!!!</span>
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(minlen):
            <span style="color:#66d9ef">if</span> x[i]<span style="color:#f92672">==</span>y[j]: s[j]<span style="color:#f92672">=</span>t<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
            <span style="color:#66d9ef">else</span>: s[j]<span style="color:#f92672">=</span>max(s[j],s[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
            t<span style="color:#f92672">=</span>s[j]
    <span style="color:#66d9ef">return</span> s

x,y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;abcde&#39;</span>,<span style="color:#e6db74">&#39;oaobce&#39;</span>
s<span style="color:#f92672">=</span>lcs4(x,y)
<span style="color:#66d9ef">print</span>(s) <span style="color:#75715e">#[3, 3, 3, 3, 4]</span>
</code></pre></div>
    </section>

    <footer class="post-footer">
      
        <figure class="author-image">
            <a class="img" href="https://hujiaweibujidao.github.io/" style="background-image: url(https://hujiaweibujidao.github.io/images/logo.gif)"><span class="hidden">hujiawei's Picture</span></a>
        </figure>
      

      





<section class="author" style="width:100%;">
  <div class="author-meta" style="width:100%;text-align:center;">
    <span class="author-location icon-user"> Hujiawei is a mobile developer</span>
    <span class="author-location icon-location"> Guangdong, China</span>
    <span class="author-link icon-link"><a href="https://hujiaweibujidao.github.io/"> https://hujiaweibujidao.github.io/</a></span>
    

    
  </div>
  <br/>
</section>


      
        <aside class="read-next">
  
      <span class="readmore-prev readmore-meta">PREV: <a href="https://hujiaweibujidao.github.io/blog/2014/05/20/problem-delete-number-problem/"><h4>Problem: Delete Number Problem</h4></a></span>
      
  

  
      <span class="readmore-next readmore-meta">NEXT: <a href="https://hujiaweibujidao.github.io/blog/2014/05/18/love-you/"><h4>Love you</h4></a></span>
      
  
</aside>
<br/>

      
      
      
    </footer>
</article>

</main>

    <footer class="site-footer clearfix">
        <a id="gotop" class="icon-arrow-up" href="#" title="back to top"></a>

        <section class="copyright"><a href="">Hujiawei Bujidao. </a> All rights reserved &copy; 2013 - 2020</section>
        
        <section class="poweredby">Proudly generated by <a href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme &nbsp;
            
            <script type="text/javascript">
                var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
                document.write(unescape("%3Cspan id='cnzz_stat_icon_1000165127'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s22.cnzz.com/z_stat.php%3Fid%3D1000165127%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
            </script>
        </section>
        
    </footer>
  </div> 
    <script type="text/javascript" src="https://hujiaweibujidao.github.io/js/jquery.js"></script>
    <script type="text/javascript" src="https://hujiaweibujidao.github.io/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://hujiaweibujidao.github.io/js/index.js"></script>

    
    
    
    

    
</body>
</html>

